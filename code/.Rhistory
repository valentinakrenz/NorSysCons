#preparation
#load packages
library(readxl)
library(ez)
library(ggplot2)
library(psych)
library(lsr)
library(rstatix)
library(Rmisc)
library(ggpubr)
library(tidyverse)
library(lme4)
library(lmerTest)
library(sjPlot)
#set working directory to source file location
rstudioapi::getActiveDocumentContext
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#load wide file data
wide_file <- read_excel('./data.xlsx')
#define factos
wide_file$Name <- factor(wide_file$Name)
wide_file$drug <- factor(wide_file$drug)
wide_file$delay <- factor(wide_file$delay)
wide_file$group <- factor(wide_file$group)
#don't use scientific notation for p-values
options(scipen=999)
#load wide file data
wide_file <- read_excel('./data.xlsx')
#load wide file data
wide_file <- read_excel('C:/Users/ap2mitarbeiter.AP2-4037/Documents/GitHub/NorSysCons/data/wideFile.xlsx')
#define factos
wide_file$Name <- factor(wide_file$Name)
wide_file$drug <- factor(wide_file$drug)
wide_file$delay <- factor(wide_file$delay)
wide_file$group <- factor(wide_file$group)
#don't use scientific notation for p-values
options(scipen=999)
#delay x drug x emotion LMM on dPrime####
#prepare long_file
long_file <- wide_file %>%
select(Name, drug, delay, dPrime_neutral, dPrime_negative) %>%
pivot_longer(cols = c(dPrime_neutral, dPrime_negative),
names_to = "Emotion",
values_to = "dPrime")
#name levels of Emotion
long_file$Emotion <- factor(long_file$Emotion, levels = c("dPrime_neutral", "dPrime_negative"),
labels = c("neutral","negative"))
#rename levels/ groups for plots
levels(long_file$drug)[levels(long_file$drug)=="0"] <- "PLAC"
levels(long_file$drug)[levels(long_file$drug)=="1"] <- "YOH"
levels(long_file$delay)[levels(long_file$delay)=="0"] <- "1d"
levels(long_file$delay)[levels(long_file$delay)=="1"] <- "28d"
#run LMM
dPrime_GLM <- lmer(dPrime ~ delay*drug*Emotion +
(1 | Name), data = long_file)
#show results (for t-value)
summary(dPrime_GLM)
#show results (for CI)
sjPlot::tab_model(dPrime_GLM)
#marginal effects plot for delayed recognition (supplementary figure 2)####
my_y_title <- expression(paste(bold("day 2:"), " delayed recognition ( ", italic("d'"), ")"))
#drugxdelay(xemotion)-Plot
p <- plot_model(dPrime_GLM, type = "pred", terms = c("drug","delay","Emotion"),
show.data = FALSE, value.offset = TRUE, jitter = TRUE,
dot.size = 4, grid = FALSE, line.size = 2,
axis.title = c("drug",my_y_title), #set x-and y-axis title
colors = c("lightsteelblue","lightsteelblue4")) # colours
p + theme(
strip.text = element_text(size=26, colour="white"),
strip.background = element_rect(fill="black"),
axis.title.y=element_text(size=28, vjust=0.5, colour="black"),
axis.text.y = element_text(size = 26, colour="black", hjust=-1),
axis.title.x=element_text(size=28, colour="black", vjust=-0.5),
axis.text.x = element_text(size = 28, colour="black", vjust=-0.25),
legend.title = element_text(size = 28),
legend.text = element_text(size = 26),
axis.line = element_line(size=1.75),
axis.ticks = element_line(size=1.0, colour="black"),
axis.ticks.length = unit(.0,"cm")
)
?ggpredict
